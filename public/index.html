<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>GiftBot</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}

:root{
  --bg:#0a0a0a;
  --bg2:#0f0f0f;
  --glass:rgba(28,30,32,0.85);
  --glass2:rgba(22,24,26,0.9);
  --glass-border:rgba(255,255,255,0.07);
  --glass-shine:rgba(255,255,255,0.04);
  --green:#2ecc71;
  --green2:#27ae60;
  --gdim:rgba(46,204,113,0.12);
  --gbor:rgba(46,204,113,0.25);
  --red:#ff6060;
  --rdim:rgba(255,96,96,0.12);
  --text:#f0f0f0;
  --muted:#555;
  --muted2:#777;
  --nav:#111213;
}

html,body{
  background:var(--bg);
  color:var(--text);
  font-family:-apple-system,'SF Pro Display','Helvetica Neue',sans-serif;
  height:100%;overflow:hidden;
  overscroll-behavior:none;
}

/* â•â•â• APP SHELL â•â•â• */
.app{
  display:flex;flex-direction:column;
  height:100vh;height:100dvh;
  background:var(--bg);
}
.pages{flex:1;overflow:hidden;position:relative}

/* â•â•â• PAGE TRANSITIONS â•â•â• */
.page{
  display:none;position:absolute;inset:0;
  overflow-y:auto;overflow-x:hidden;
  -webkit-overflow-scrolling:touch;
  padding:16px 14px calc(62px + env(safe-area-inset-bottom));
  overscroll-behavior-y:contain;
  will-change:transform,opacity;
}
.page::-webkit-scrollbar{display:none}

.page.active{
  display:block;
  animation:pageIn .28s cubic-bezier(.4,0,.2,1) forwards;
}
.page.exit{
  display:block;
  animation:pageOut .22s cubic-bezier(.4,0,.2,1) forwards;
  pointer-events:none;
}
@keyframes pageIn{
  from{opacity:0;transform:translateY(10px)}
  to{opacity:1;transform:translateY(0)}
}
@keyframes pageOut{
  from{opacity:1;transform:translateY(0)}
  to{opacity:0;transform:translateY(-6px)}
}

/* â•â•â• BOTTOM NAV â•â•â• */
.nav{
  flex-shrink:0;
  display:flex;align-items:center;justify-content:center;
  background:var(--nav);
  border-top:1px solid rgba(255,255,255,0.05);
  padding:0 8px;
  padding-bottom:env(safe-area-inset-bottom);
  height:calc(52px + env(safe-area-inset-bottom));
}
.nb{
  flex:1;display:flex;flex-direction:column;align-items:center;
  justify-content:center;gap:3px;cursor:pointer;
  color:var(--muted);font-size:10px;font-weight:500;
  border:none;background:none;font-family:inherit;
  transition:color .2s;padding:6px 2px;
  position:relative;
}
.nb svg{
  width:20px;height:20px;stroke:currentColor;fill:none;
  stroke-width:1.8;stroke-linecap:round;stroke-linejoin:round;
  transition:all .2s;
}
.nb-dot{
  position:absolute;top:6px;right:calc(50% - 16px);
  width:5px;height:5px;border-radius:50%;
  background:var(--green);
  display:none;
}
.nb.active{color:var(--green)}
.nb.active .nb-bg{
  position:absolute;top:50%;left:50%;
  transform:translate(-50%,-50%);
  width:40px;height:36px;border-radius:10px;
  background:var(--gdim);
  z-index:0;
}
.nb>*{position:relative;z-index:1}

/* â•â•â• GLASS CARD â•â•â• */
.gc{
  background:var(--glass);
  backdrop-filter:blur(20px) saturate(140%);
  -webkit-backdrop-filter:blur(20px) saturate(140%);
  border:1px solid var(--glass-border);
  border-radius:16px;
  position:relative;overflow:hidden;
}
.gc::before{
  content:'';position:absolute;
  top:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,0.08),transparent);
}
.gc::after{
  content:'';position:absolute;
  top:0;left:0;width:100%;height:100%;
  background:linear-gradient(135deg,rgba(255,255,255,0.03) 0%,transparent 60%);
  pointer-events:none;
}

/* â•â•â• SHARED â•â•â• */
.phdr{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
.ptitle{font-size:24px;font-weight:800;letter-spacing:-.5px}
.bpill{
  display:flex;align-items:center;gap:5px;
  background:var(--gdim);border:1px solid var(--gbor);
  border-radius:20px;padding:6px 12px;
  font-size:15px;font-weight:700;color:var(--green);flex-shrink:0;
}
.bpill-ico{
  width:16px;height:16px;display:flex;align-items:center;justify-content:center;
}
.bpill-ico svg{width:16px;height:16px;stroke:var(--green);fill:none;stroke-width:2;stroke-linecap:round}
.sec{font-size:16px;font-weight:700;margin-bottom:12px;color:var(--text)}

/* â•â•â• HOME â•â•â• */
.hhdr{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
.huser{display:flex;align-items:center;gap:11px}
.av{
  width:52px;height:52px;border-radius:50%;
  background:linear-gradient(135deg,#2ecc71,#1a7a40);
  display:flex;align-items:center;justify-content:center;
  font-size:20px;font-weight:700;
  border:2px solid rgba(46,204,113,0.4);
  box-shadow:0 0 20px rgba(46,204,113,0.2);
  overflow:hidden;flex-shrink:0;
}
.av img{width:100%;height:100%;object-fit:cover}
.welcome{font-size:12px;color:var(--muted2);margin-bottom:3px}
.username-grad{
  font-size:20px;font-weight:800;
  background:linear-gradient(135deg,#ffffff 0%,#2ecc71 60%,#27ae60 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  background-clip:text;display:flex;align-items:center;gap:6px;
}
.username-grad .gem{
  -webkit-text-fill-color:initial;
  font-size:17px;
}

/* Menu 2Ã—2 */
.mgrid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:12px}
.mc{
  background:var(--glass);
  backdrop-filter:blur(20px) saturate(140%);
  -webkit-backdrop-filter:blur(20px) saturate(140%);
  border:1px solid var(--glass-border);
  border-radius:18px;padding:20px 12px 16px;
  display:flex;flex-direction:column;align-items:center;gap:10px;
  cursor:pointer;transition:transform .12s,background .12s;
  user-select:none;position:relative;overflow:hidden;
}
.mc::before{
  content:'';position:absolute;top:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,0.08),transparent);
}
.mc::after{
  content:'';position:absolute;top:0;left:0;width:100%;height:100%;
  background:linear-gradient(155deg,rgba(255,255,255,0.03) 0%,transparent 55%);
  pointer-events:none;
}
.mc:active{transform:scale(.96);background:rgba(32,35,38,0.95)}
.mc-ico{
  width:44px;height:44px;border-radius:14px;
  background:var(--gdim);border:1px solid var(--gbor);
  display:flex;align-items:center;justify-content:center;
  position:relative;z-index:1;
}
.mc-ico svg{width:24px;height:24px;stroke:var(--green);fill:none;stroke-width:1.8;stroke-linecap:round;stroke-linejoin:round}
.mc-t{font-size:14px;font-weight:700;position:relative;z-index:1;text-align:center}
.mc-s{font-size:11px;color:var(--muted2);text-align:center;position:relative;z-index:1}

/* Promo card */
.pcard{padding:14px;margin-bottom:12px}
.plbl{display:flex;align-items:center;gap:7px;font-size:13px;font-weight:600;color:var(--green);margin-bottom:10px}
.prow{display:flex;gap:8px}
.pin{
  flex:1;background:rgba(0,0,0,0.4);border:1px solid rgba(255,255,255,0.08);
  border-radius:11px;padding:11px 13px;color:var(--muted2);
  font-size:14px;outline:none;font-family:inherit;transition:border-color .2s,color .2s;
}
.pin:focus{border-color:var(--green);color:var(--text)}
.pbtn{
  background:var(--green);color:#000;border:none;border-radius:11px;
  padding:11px 16px;font-size:13px;font-weight:700;cursor:pointer;
  font-family:inherit;white-space:nowrap;transition:transform .1s;
}
.pbtn:active{transform:scale(.95);background:var(--green2)}

/* Home raffles */
.rahdr{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
.seeall{
  background:var(--gdim);color:var(--green);border:none;border-radius:10px;
  padding:5px 12px;font-size:12px;font-weight:600;cursor:pointer;font-family:inherit;
}
.rarow{display:flex;gap:10px;overflow-x:auto;padding-bottom:4px}
.rarow::-webkit-scrollbar{display:none}
.rthumb{
  min-width:140px;height:100px;border-radius:14px;
  background:var(--glass);border:1px solid var(--glass-border);
  overflow:hidden;cursor:pointer;position:relative;
  display:flex;align-items:flex-end;flex-shrink:0;
  transition:transform .12s;
}
.rthumb:active{transform:scale(.97)}
.rtbg{
  position:absolute;inset:0;display:flex;align-items:center;justify-content:center;
  font-size:36px;opacity:.35;
}
.rtlbl{
  position:relative;z-index:1;width:100%;
  background:linear-gradient(transparent,rgba(0,0,0,.8));padding:7px 9px;
}
.rtprize{font-size:14px;font-weight:900;color:var(--green)}
.rtsub{font-size:10px;color:var(--muted2)}

/* â•â•â• TASKS â•â•â• */
.ti{
  padding:13px 14px;display:flex;align-items:center;gap:13px;
  margin-bottom:8px;cursor:pointer;transition:transform .1s;
}
.ti:active{transform:scale(.98)}
.tico{
  width:42px;height:42px;border-radius:12px;background:var(--gdim);
  border:1px solid var(--gbor);
  display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;
}
.tinf{flex:1;min-width:0}
.ttag{
  display:inline-block;border-radius:5px;padding:2px 6px;
  font-size:10px;font-weight:700;margin-bottom:3px;letter-spacing:.3px;
}
.ttag.r{background:var(--rdim);color:var(--red)}
.ttag.g{background:var(--gdim);color:var(--green)}
.tname{font-size:13px;font-weight:600;margin-bottom:1px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.tdesc{font-size:11px;color:var(--muted2)}
.trew{color:var(--green);font-weight:700;font-size:12px;white-space:nowrap;flex-shrink:0}
.tdone{
  background:var(--gdim);color:var(--green);border-radius:8px;
  padding:4px 9px;font-size:11px;font-weight:700;flex-shrink:0;
}

/* â•â•â• SHOP â•â•â• */
.stabs{display:flex;gap:6px;margin-bottom:14px;background:rgba(0,0,0,.3);border-radius:12px;padding:4px}
.stab{
  flex:1;padding:9px;border-radius:9px;border:none;
  background:transparent;color:var(--muted);font-size:13px;font-weight:600;
  cursor:pointer;font-family:inherit;transition:all .2s;
}
.stab.active{background:var(--glass);color:var(--text);box-shadow:0 2px 8px rgba(0,0,0,.3)}

.sgrid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.sitem{
  padding:14px 10px 12px;text-align:center;cursor:pointer;
  transition:transform .1s;
}
.sitem:active{transform:scale(.96)}
.sico{font-size:34px;margin-bottom:7px}
.sname{font-size:12px;font-weight:600;margin-bottom:5px}
.sprice{color:var(--green);font-weight:700;font-size:12px;margin-bottom:9px}
.sbuy{
  width:100%;background:var(--green);color:#000;border:none;
  border-radius:9px;padding:8px;font-size:12px;font-weight:700;
  cursor:pointer;font-family:inherit;transition:background .1s;
}
.sbuy:active{background:var(--green2)}
.sbuy:disabled{background:rgba(255,255,255,0.07);color:var(--muted);cursor:not-allowed}

/* Cases */
.cgrid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.ccard{
  cursor:pointer;transition:transform .12s;overflow:hidden;
  border-radius:16px;
}
.ccard:active{transform:scale(.96)}
.ccimg{
  height:100px;display:flex;flex-direction:column;align-items:center;
  justify-content:center;gap:6px;position:relative;overflow:hidden;
}
.ccimg-ico{
  width:52px;height:52px;border-radius:16px;
  display:flex;align-items:center;justify-content:center;
  position:relative;z-index:1;
}
.ccimg-ico svg{width:28px;height:28px;stroke-width:1.6;stroke-linecap:round;stroke-linejoin:round;fill:none}
.ccimg::before{
  content:'';position:absolute;inset:0;
  background:radial-gradient(circle at 50% 30%,rgba(255,255,255,0.06) 0%,transparent 70%);
}
.ccinfo{padding:8px 10px 12px;background:var(--glass)}
.ccname{font-size:12px;font-weight:700;margin-bottom:3px}
.ccprice{color:var(--green);font-weight:700;font-size:11px;display:flex;align-items:center;gap:4px}
.ccprice svg{width:12px;height:12px;stroke:var(--green);fill:none;stroke-width:2}

/* â•â•â• CASE MODAL â•â•â• */
.cmo{
  display:none;position:fixed;inset:0;
  background:rgba(0,0,0,.88);backdrop-filter:blur(8px);
  z-index:700;flex-direction:column;align-items:center;justify-content:center;padding:16px;
}
.cmo.show{display:flex}
.cmbox{
  background:#161819;border-radius:22px;width:100%;max-width:430px;
  overflow:hidden;border:1px solid rgba(255,255,255,.08);
  animation:cin .32s cubic-bezier(.34,1.5,.64,1);
}
@keyframes cin{from{transform:scale(.82);opacity:0}to{transform:scale(1);opacity:1}}
.cmhdr{
  display:flex;align-items:center;justify-content:space-between;
  padding:16px 16px 12px;
  border-bottom:1px solid rgba(255,255,255,.06);
}
.cmtitle{font-size:17px;font-weight:800;display:flex;align-items:center;gap:8px}
.cmclose{
  width:30px;height:30px;border-radius:50%;background:rgba(255,255,255,.06);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;font-size:16px;color:var(--muted2);border:none;font-family:inherit;
}
.rw{
  position:relative;overflow:hidden;height:108px;
  background:#0d0e0f;
}
.rw::before,.rw::after{
  content:'';position:absolute;top:0;bottom:0;width:60px;z-index:2;pointer-events:none;
}
.rw::before{left:0;background:linear-gradient(90deg,#0d0e0f,transparent)}
.rw::after{right:0;background:linear-gradient(-90deg,#0d0e0f,transparent)}
.rtrack{display:flex;gap:6px;padding:6px;will-change:transform}
.ritem{
  min-width:88px;height:96px;border-radius:11px;flex-shrink:0;
  display:flex;flex-direction:column;align-items:center;justify-content:center;gap:4px;
  background:#1a1c1e;border:1.5px solid rgba(255,255,255,.06);
  transition:border-color .3s,background .3s;
}
.ritem.win{border-color:var(--green)!important;background:#0d2218!important;box-shadow:0 0 16px rgba(46,204,113,.2)}
.rico{font-size:28px}
.rname{font-size:9px;color:var(--muted2);font-weight:600;text-align:center;padding:0 4px}
.rval{font-size:10px;color:var(--green);font-weight:700}
.rcline{
  position:absolute;top:0;bottom:0;left:50%;width:2px;
  background:var(--green);transform:translateX(-50%);
  box-shadow:0 0 12px var(--green);pointer-events:none;z-index:3;
}
.rca-t{
  position:absolute;top:0;left:50%;transform:translateX(-50%);z-index:4;
  border-left:7px solid transparent;border-right:7px solid transparent;
  border-top:9px solid var(--green);pointer-events:none;
}
.rca-b{
  position:absolute;bottom:0;left:50%;transform:translateX(-50%);z-index:4;
  border-left:7px solid transparent;border-right:7px solid transparent;
  border-bottom:9px solid var(--green);pointer-events:none;
}
.cmfoot{padding:14px 16px}
.cmcost{text-align:center;font-size:12px;color:var(--muted2);margin-bottom:10px}
.cmspin{
  width:100%;background:var(--green);color:#000;border:none;
  border-radius:13px;padding:14px;font-size:15px;font-weight:800;
  cursor:pointer;font-family:inherit;transition:all .15s;
}
.cmspin:active{background:var(--green2);transform:scale(.98)}
.cmspin:disabled{background:rgba(255,255,255,.07);color:var(--muted);cursor:not-allowed}
.cres{display:none;padding:24px 20px;text-align:center}
.cres.show{display:block}
.cres-ico{font-size:64px;display:block;margin-bottom:12px;animation:bounce .5s ease}
@keyframes bounce{0%,100%{transform:scale(1)}50%{transform:scale(1.16)}}
.cres-t{font-size:20px;font-weight:800;margin-bottom:5px}
.cres-s{font-size:13px;color:var(--muted2);margin-bottom:20px}
.cres-btn{
  width:100%;background:var(--green);color:#000;border:none;
  border-radius:13px;padding:13px;font-size:14px;font-weight:700;cursor:pointer;font-family:inherit;
}

/* â•â•â• RAFFLES â•â•â• */
.rcard{padding:13px 14px;margin-bottom:8px}
.rchdr{display:flex;align-items:flex-start;justify-content:space-between;gap:10px;margin-bottom:10px}
.rcico{
  width:42px;height:42px;border-radius:12px;background:var(--gdim);
  border:1px solid var(--gbor);
  display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;
}
.rcinfo{flex:1}
.rcname{font-size:14px;font-weight:700;margin-bottom:2px}
.rcdesc{font-size:11px;color:var(--muted2)}
.rcprize{font-size:18px;font-weight:900;color:var(--green);white-space:nowrap}
.rprog{background:rgba(255,255,255,.07);border-radius:4px;height:3px;margin-bottom:7px;overflow:hidden}
.rfill{background:var(--green);border-radius:4px;height:100%}
.rcft{display:flex;align-items:center;justify-content:space-between}
.rcparts{font-size:11px;color:var(--muted2)}
.rjoin{
  background:var(--green);color:#000;border:none;border-radius:9px;
  padding:7px 13px;font-size:12px;font-weight:700;cursor:pointer;font-family:inherit;
}
.rjoin:active{background:var(--green2)}
.rjoined{
  background:var(--gdim);color:var(--green);border:1px solid var(--gbor);
  border-radius:9px;padding:6px 13px;font-size:12px;font-weight:700;
}

/* â•â•â• FRIENDS â•â•â• */
.refblock{
  background:rgba(46,204,113,0.08);border:1px solid rgba(46,204,113,0.2);
  border-radius:16px;padding:16px;margin-bottom:14px;
  position:relative;overflow:hidden;
}
.refblock::before{
  content:'';position:absolute;top:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent,rgba(46,204,113,0.4),transparent);
}
.reflbl{font-size:10px;font-weight:700;color:var(--green);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px}
.refdesc{font-size:13px;color:var(--muted2);margin-bottom:3px}
.refamt{font-size:26px;font-weight:900;color:var(--green);margin-bottom:12px;display:flex;align-items:center;gap:7px}
.refamt svg{width:20px;height:20px;stroke:var(--green);fill:none;stroke-width:2}
.refwarn{
  background:var(--rdim);border:1px solid rgba(255,96,96,0.2);
  border-radius:11px;padding:10px 12px;margin-bottom:12px;
  font-size:12px;color:var(--red);line-height:1.5;font-weight:500;
}
.reflinkrow{
  background:rgba(0,0,0,.3);border:1px solid rgba(46,204,113,0.2);
  border-radius:11px;padding:10px 12px;margin-bottom:10px;
  display:flex;align-items:center;gap:8px;
}
.reflinkt{flex:1;font-size:12px;color:var(--green);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:monospace}
.refcopy{
  width:34px;height:34px;background:var(--gdim);border:none;border-radius:9px;
  display:flex;align-items:center;justify-content:center;cursor:pointer;flex-shrink:0;
}
.refcopy svg{width:15px;height:15px;stroke:var(--green);fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
.refshare{
  width:100%;background:var(--green);color:#000;border:none;
  border-radius:13px;padding:13px;font-size:15px;font-weight:700;
  cursor:pointer;font-family:inherit;transition:all .15s;
}
.refshare:active{background:var(--green2);transform:scale(.98)}

.refstats{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:14px}
.rstat{padding:12px 6px;text-align:center}
.rslbl{font-size:9px;color:var(--muted);text-transform:uppercase;letter-spacing:.5px;font-weight:600;margin-bottom:7px;line-height:1.4}
.rsval{font-size:22px;font-weight:900}
.rsval.g{font-size:18px;color:var(--green);display:flex;align-items:center;justify-content:center;gap:3px}
.rsval.g svg{width:14px;height:14px;stroke:var(--green);fill:none;stroke-width:2}
.rssub{font-size:9px;color:var(--muted);margin-top:3px}

.rtask{padding:13px 14px;margin-bottom:14px}
.rtop{display:flex;align-items:center;justify-content:space-between;margin-bottom:5px}
.rtag{background:var(--rdim);color:var(--red);border-radius:20px;padding:3px 9px;font-size:11px;font-weight:600}
.rprize{color:var(--green);font-weight:700;font-size:13px;display:flex;align-items:center;gap:4px}
.rprize svg{width:13px;height:13px;stroke:var(--green);fill:none;stroke-width:2}
.rtitle{font-size:15px;font-weight:700;margin-bottom:5px}
.rdesc{font-size:12px;color:var(--muted2);line-height:1.5;margin-bottom:10px}
.rpb{background:rgba(255,255,255,.07);border-radius:4px;height:3px;margin-bottom:5px}
.rpbf{background:var(--green);border-radius:4px;height:100%;width:0%;transition:width .5s}
.rpr{display:flex;justify-content:flex-end;font-size:11px;color:var(--muted)}

.norefs{display:flex;flex-direction:column;align-items:center;padding:36px 20px;gap:12px}
.nrico{font-size:48px;opacity:.2}
.nrt{font-size:17px;font-weight:700;color:#333}
.nrs{font-size:12px;color:var(--muted);text-align:center}

/* â•â•â• PROFILE â•â•â• */
.profuc{
  padding:14px;margin-bottom:10px;
  display:flex;align-items:center;gap:13px;
}
.profav{
  width:60px;height:60px;border-radius:50%;
  background:linear-gradient(135deg,var(--green),#1a7a40);
  display:flex;align-items:center;justify-content:center;
  font-size:24px;font-weight:700;
  border:2px solid rgba(46,204,113,.4);
  box-shadow:0 0 20px rgba(46,204,113,.2);
  overflow:hidden;flex-shrink:0;
}
.profav img{width:100%;height:100%;object-fit:cover}
.profname{
  font-size:19px;font-weight:800;margin-bottom:3px;
  background:linear-gradient(135deg,#ffffff 0%,#2ecc71 60%,#27ae60 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}
.profun{font-size:13px;color:var(--muted2)}

.prow{
  padding:13px 14px;margin-bottom:8px;
  display:flex;align-items:center;gap:13px;
}
.prow-c{cursor:pointer;transition:transform .1s}
.prow-c:active{transform:scale(.98)}
.pro-ico{width:26px;text-align:center;color:var(--green);flex-shrink:0}
.pro-ico svg{width:20px;height:20px;stroke:currentColor;fill:none;stroke-width:1.8;stroke-linecap:round;stroke-linejoin:round}
.pro-c2{flex:1}
.pro-l{font-size:11px;color:var(--muted2);margin-bottom:2px}
.pro-v{font-size:15px;font-weight:600}
.pro-arr{color:var(--muted);font-size:18px}
.pro-info{
  width:26px;height:26px;border-radius:50%;background:var(--gdim);
  display:flex;align-items:center;justify-content:center;cursor:pointer;border:none;
}
.pro-info svg{width:12px;height:12px;stroke:var(--green);fill:none;stroke-width:2;stroke-linecap:round}

.profpromo{padding:14px}
.profplbl{display:flex;align-items:center;gap:7px;font-size:13px;font-weight:600;color:var(--green);margin-bottom:10px}

/* â•â•â• BOTTOM SHEET â•â•â• */
.shov{
  display:none;position:fixed;inset:0;
  background:rgba(0,0,0,.65);backdrop-filter:blur(4px);
  z-index:400;align-items:flex-end;
}
.shov.show{display:flex}
.sh{
  background:#161819;border-radius:22px 22px 0 0;width:100%;
  padding:0 0 calc(22px + env(safe-area-inset-bottom));
  border-top:1px solid rgba(255,255,255,.07);
  animation:shup .24s cubic-bezier(.4,0,.2,1);
}
@keyframes shup{from{transform:translateY(100%)}to{transform:translateY(0)}}
.sh-h{width:36px;height:4px;background:rgba(255,255,255,.12);border-radius:4px;margin:12px auto 18px}
.sh-t{font-size:17px;font-weight:800;padding:0 18px;margin-bottom:5px}
.sh-s{font-size:12px;color:var(--muted2);padding:0 18px;margin-bottom:18px}
.sh-a{
  width:calc(100% - 36px);margin:0 18px;background:var(--green);color:#000;
  border:none;border-radius:13px;padding:14px;font-size:14px;font-weight:700;
  cursor:pointer;font-family:inherit;
}
.sh-c{
  width:calc(100% - 36px);margin:8px 18px 0;
  background:rgba(255,255,255,.06);color:var(--text);
  border:none;border-radius:13px;padding:14px;font-size:14px;font-weight:600;
  cursor:pointer;font-family:inherit;
}

/* â•â•â• TOAST â•â•â• */
.toast{
  position:fixed;top:16px;left:50%;
  transform:translateX(-50%) translateY(-80px);
  background:#1a2e1a;border:1px solid rgba(46,204,113,.3);
  color:var(--green);padding:9px 18px;border-radius:18px;
  font-size:13px;font-weight:600;z-index:9999;
  transition:transform .3s cubic-bezier(.34,1.5,.64,1);
  white-space:nowrap;pointer-events:none;
}
.toast.show{transform:translateX(-50%) translateY(0)}

/* â•â•â• EMPTY STATE â•â•â• */
.empty{
  display:flex;flex-direction:column;align-items:center;
  padding:40px 20px;gap:10px;
}
.empty-ico{font-size:44px;opacity:.2}
.empty-t{font-size:15px;font-weight:700;color:#333}
.empty-s{font-size:12px;color:var(--muted);text-align:center}
</style>
</head>
<body>

<div class="toast" id="toast"></div>

<!-- BOTTOM SHEET -->
<div class="shov" id="sheet" onclick="closeSheet(event)">
  <div class="sh">
    <div class="sh-h"></div>
    <div class="sh-t" id="sh-t"></div>
    <div class="sh-s" id="sh-s"></div>
    <button class="sh-a" id="sh-a" onclick="doSheet()"></button>
    <button class="sh-c" onclick="closeSheet()">ĞÑ‚Ğ¼ĞµĞ½Ğ°</button>
  </div>
</div>

<!-- CASE MODAL -->
<div class="cmo" id="cmo">
  <div class="cmbox">
    <div class="cmhdr">
      <div class="cmtitle" id="cm-t">ğŸ“¦ ĞšĞµĞ¹Ñ</div>
      <button class="cmclose" onclick="closeCase()">âœ•</button>
    </div>
    <div id="cm-spin">
      <div class="rw">
        <div class="rtrack" id="rtrack"></div>
        <div class="rcline"></div>
        <div class="rca-t"></div>
        <div class="rca-b"></div>
      </div>
      <div class="cmfoot">
        <div class="cmcost" id="cm-cost"></div>
        <button class="cmspin" id="cm-btn" onclick="spinCase()">ğŸ° ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ ĞºĞµĞ¹Ñ</button>
      </div>
    </div>
    <div class="cres" id="cres">
      <span class="cres-ico" id="cr-ico">ğŸ</span>
      <div class="cres-t" id="cr-t">ĞŸĞ¾Ğ·Ğ´Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼!</div>
      <div class="cres-s" id="cr-s">Ğ’Ñ‹ Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»Ğ¸</div>
      <button class="cres-btn" onclick="closeCase()">Ğ—Ğ°Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ½Ğ°Ğ³Ñ€Ğ°Ğ´Ñƒ</button>
    </div>
  </div>
</div>

<div class="app">
<div class="pages">

<!-- â•â• HOME â•â• -->
<div class="page active" id="page-home">
  <div class="hhdr">
    <div class="huser">
      <div class="av" id="av-h">?</div>
      <div>
        <div class="welcome">Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ,</div>
        <div class="username-grad">
          <span id="h-name">User</span>
        </div>
      </div>
    </div>
    <div class="bpill">
      <div class="bpill-ico"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
      <span id="b-home">0</span>
    </div>
  </div>

  <div class="mgrid">
    <div class="mc" onclick="go('tasks')">
      <div class="mc-ico">
        <svg viewBox="0 0 24 24"><polyline points="9 11 12 14 22 4"/><path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/></svg>
      </div>
      <div class="mc-t">Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ</div>
      <div class="mc-s">Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞ¹ Ğ¸ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ¹</div>
    </div>
    <div class="mc" onclick="go('shop')">
      <div class="mc-ico">
        <svg viewBox="0 0 24 24"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 001.98 1.61h9.72a2 2 0 001.98-1.61L23 6H6"/></svg>
      </div>
      <div class="mc-t">ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½</div>
      <div class="mc-s">Ğ¢Ñ€Ğ°Ñ‚ÑŒ Ğ¼Ğ¾Ğ½ĞµÑ‚Ñ‹</div>
    </div>
    <div class="mc" onclick="go('raffles')">
      <div class="mc-ico">
        <svg viewBox="0 0 24 24"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M16 7V5a2 2 0 00-2-2h-4a2 2 0 00-2 2v2"/><line x1="12" y1="12" x2="12" y2="16"/><line x1="10" y1="14" x2="14" y2="14"/></svg>
      </div>
      <div class="mc-t">Ğ Ğ¾Ğ·Ñ‹Ğ³Ñ€Ñ‹ÑˆĞ¸</div>
      <div class="mc-s">Ğ˜ÑĞ¿Ñ‹Ñ‚Ğ°Ğ¹ ÑƒĞ´Ğ°Ñ‡Ñƒ</div>
    </div>
    <div class="mc" onclick="go('friends')">
      <div class="mc-ico">
        <svg viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/></svg>
      </div>
      <div class="mc-t">Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»Ñ‹</div>
      <div class="mc-s">ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞ°Ğ¹ Ğ´Ñ€ÑƒĞ·ĞµĞ¹</div>
    </div>
  </div>

  <div class="gc pcard">
    <div class="plbl">
      <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="1" y="4" width="22" height="16" rx="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
      ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´
    </div>
    <div class="prow">
      <input class="pin" id="pi-h" placeholder="Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´" type="text" autocapitalize="characters">
      <button class="pbtn" onclick="usePromo('pi-h')">ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ</button>
    </div>
  </div>

  <div class="rahdr">
    <div class="sec" style="margin-bottom:0">ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ñ€Ğ¾Ğ·Ñ‹Ğ³Ñ€Ñ‹ÑˆĞ¸</div>
    <button class="seeall" onclick="go('raffles')">Ğ’ÑĞµ</button>
  </div>
  <div class="rarow" id="h-raf"></div>
</div>

<!-- â•â• TASKS â•â• -->
<div class="page" id="page-tasks">
  <div class="phdr">
    <div class="ptitle">Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ</div>
    <div class="bpill">
      <div class="bpill-ico"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
      <span id="b-tasks">0</span>
    </div>
  </div>
  <div id="tasks-list"></div>
</div>

<!-- â•â• SHOP â•â• -->
<div class="page" id="page-shop">
  <div class="phdr">
    <div class="ptitle">ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½</div>
    <div class="bpill">
      <div class="bpill-ico"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
      <span id="b-shop">0</span>
    </div>
  </div>
  <div class="stabs">
    <button class="stab active" onclick="shopTab('items',this)">ğŸ›’ ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½</button>
    <button class="stab" onclick="shopTab('cases',this)">ğŸ“¦ ĞšĞµĞ¹ÑÑ‹</button>
  </div>
  <div class="sgrid" id="shop-items"></div>
  <div class="cgrid" id="shop-cases" style="display:none"></div>
</div>

<!-- â•â• RAFFLES â•â• -->
<div class="page" id="page-raffles">
  <div class="phdr">
    <div class="ptitle">Ğ Ğ¾Ğ·Ñ‹Ğ³Ñ€Ñ‹ÑˆĞ¸</div>
    <div class="bpill">
      <div class="bpill-ico"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
      <span id="b-raffles">0</span>
    </div>
  </div>
  <div id="raffles-list"></div>
</div>

<!-- â•â• FRIENDS â•â• -->
<div class="page" id="page-friends">
  <div class="phdr">
    <div class="ptitle">Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»Ñ‹</div>
    <div class="bpill">
      <div class="bpill-ico"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
      <span id="b-friends">0</span>
    </div>
  </div>

  <div class="refblock">
    <div class="reflbl">Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑÑ‹Ğ»ĞºĞ°</div>
    <div class="refdesc">Ğ—Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆÑ‘Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚Ğµ</div>
    <div class="refamt">
      <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
      1 000
    </div>
    <div class="refwarn">âš ï¸ Ğ’Ğ°Ğ¶Ğ½Ğ¾: Ñƒ Ğ²Ğ°ÑˆĞµĞ³Ğ¾ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ° Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ Telegram @username, Ğ¸Ğ½Ğ°Ñ‡Ğµ Ğ¾Ğ½ Ğ½Ğµ Ğ·Ğ°ÑÑ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ÑÑ.</div>
    <div class="reflinkrow">
      <div class="reflinkt" id="ref-link">https://t.me/bot?start=...</div>
      <button class="refcopy" onclick="copyRef()">
        <svg viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
      </button>
    </div>
    <button class="refshare" onclick="shareRef()">ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒÑÑ Ğ² Telegram</button>
  </div>

  <div class="refstats">
    <div class="rstat gc">
      <div class="rslbl">Ğ›Ğ¸Ñ‡Ğ½Ğ¾ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆÑ‘Ğ½Ğ½Ñ‹Ğµ</div>
      <div class="rsval" id="ref-count1">0</div>
      <div class="rssub">1% Ñ Ğ¸Ñ… Ğ½Ğ°Ğ³Ñ€Ğ°Ğ´</div>
    </div>
    <div class="rstat gc">
      <div class="rslbl">ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑˆÑ‘Ğ½Ğ½Ñ‹Ğµ Ğ´Ñ€ÑƒĞ·ÑŒÑĞ¼Ğ¸</div>
      <div class="rsval" id="ref-count2">0</div>
      <div class="rssub">0.1% Ñ Ğ¸Ñ… Ğ½Ğ°Ğ³Ñ€Ğ°Ğ´</div>
    </div>
    <div class="rstat gc">
      <div class="rslbl">Ğ—Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ¾</div>
      <div class="rsval g" id="ref-earned">
        <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>0
      </div>
    </div>
  </div>

  <div class="rtask gc">
    <div class="rtop">
      <div class="rtag">Ğ”Ñ€ÑƒĞ·ÑŒÑ</div>
      <div class="rprize"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg> 2 000</div>
    </div>
    <div class="rtitle">ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸ 3 Ğ´Ñ€ÑƒĞ·ĞµĞ¹ (+1000 Ğ·Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾!)</div>
    <div class="rdesc">ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞ°Ğ¹ Ğ´Ñ€ÑƒĞ·ĞµĞ¹ Ğ¿Ğ¾ ÑĞ²Ğ¾ĞµĞ¹ Ñ€ĞµÑ„-ÑÑÑ‹Ğ»ĞºĞµ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸ 1000 Ğ·Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ + Ğ±Ğ¾Ğ½ÑƒÑ 2000 Ğ·Ğ° Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ!</div>
    <div class="rpb"><div class="rpbf" id="ref-prog-bar"></div></div>
    <div class="rpr" id="ref-prog-txt">0 / 3</div>
  </div>

  <div class="sec">Ğ’Ğ°ÑˆĞ¸ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»Ñ‹</div>
  <div id="ref-list"></div>
</div>

<!-- â•â• PROFILE â•â• -->
<div class="page" id="page-profile">
  <div class="phdr">
    <div class="ptitle">ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ</div>
    <div class="bpill">
      <div class="bpill-ico"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
      <span id="b-profile">0</span>
    </div>
  </div>

  <div class="gc profuc">
    <div class="profav" id="av-p">?</div>
    <div>
      <div class="profname" id="p-name">User</div>
      <div class="profun" id="p-un">@username</div>
    </div>
  </div>

  <div class="gc prow">
    <div class="pro-ico"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
    <div class="pro-c2"><div class="pro-l">Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ</div><div class="pro-v" id="p-bal">0</div></div>
    <button class="pro-info" onclick="showToast('ğŸ’¡ Ğ—Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ¹, Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑÑ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¸ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞ°Ñ Ğ´Ñ€ÑƒĞ·ĞµĞ¹')">
      <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
    </button>
  </div>

  <div class="gc prow prow-c" onclick="go('friends')">
    <div class="pro-ico"><svg viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/></svg></div>
    <div class="pro-c2"><div class="pro-l">Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ¾Ğ²</div><div class="pro-v" id="p-refs">0</div></div>
    <span class="pro-arr">â€º</span>
  </div>

  <div class="gc prow">
    <div class="pro-ico"><svg viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg></div>
    <div class="pro-c2"><div class="pro-l">Ğ”Ğ°Ñ‚Ğ° Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸</div><div class="pro-v" id="p-reg">â€”</div></div>
  </div>

  <div class="gc profpromo">
    <div class="profplbl">
      <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="1" y="4" width="22" height="16" rx="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
      ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´
    </div>
    <div class="prow" style="background:transparent;border:none;padding:0;margin:0">
      <input class="pin" id="pi-p" placeholder="Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´" type="text" autocapitalize="characters">
      <button class="pbtn" onclick="usePromo('pi-p')">ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ</button>
    </div>
  </div>
</div>

</div><!-- /pages -->

<!-- NAV -->
<nav class="nav">
  <button class="nb active" id="nb-home" onclick="go('home')">
    <div class="nb-bg"></div>
    <svg viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
    <span>Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ</span>
  </button>
  <button class="nb" id="nb-tasks" onclick="go('tasks')">
    <div class="nb-bg"></div>
    <svg viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
    <span>Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ</span>
  </button>
  <button class="nb" id="nb-shop" onclick="go('shop')">
    <div class="nb-bg"></div>
    <svg viewBox="0 0 24 24"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg>
    <span>ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½</span>
  </button>
  <button class="nb" id="nb-friends" onclick="go('friends')">
    <div class="nb-bg"></div>
    <svg viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/></svg>
    <span>Ğ”Ñ€ÑƒĞ·ÑŒÑ</span>
  </button>
  <button class="nb" id="nb-profile" onclick="go('profile')">
    <div class="nb-bg"></div>
    <svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
    <span>ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ</span>
  </button>
</nav>
</div><!-- /app -->

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TELEGRAM INIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const tg = window.Telegram?.WebApp;
if (tg) { tg.ready(); tg.expand(); tg.setHeaderColor('#0a0a0a'); tg.setBackgroundColor('#0a0a0a'); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   USER DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let TGUser = null;
if (tg?.initDataUnsafe?.user) {
  TGUser = tg.initDataUnsafe.user;
} else {
  TGUser = { id: 123456, first_name: 'ik', username: 'assate', photo_url: null };
}
const UID = String(TGUser.id);

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATE (localStorage persistence)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const STORE_KEY = 'giftbot_' + UID;
const STORE_VER = 3;

function loadState() {
  try {
    const raw = localStorage.getItem(STORE_KEY);
    if (!raw) return null;
    const d = JSON.parse(raw);
    if (d.ver !== STORE_VER) return null;
    return d;
  } catch { return null; }
}

function saveState() {
  try {
    localStorage.setItem(STORE_KEY, JSON.stringify({
      ver: STORE_VER,
      balance: S.balance,
      doneTasks: [...S.doneTasks],
      usedPromos: [...S.usedPromos],
      joinedRaffles: [...S.joinedRaffles],
      regDate: S.regDate,
      refs: S.refs,
      refEarned: S.refEarned,
      refBy: S.refBy,
      // Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ±Ğ°Ğ·Ğ° Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´Ğ¾Ğ² (Ğ·Ğ° ÑÑ‚Ğ¸Ğ¼ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼)
      globalPromos: [...S.globalUsedPromos],
    }));
  } catch {}
}

// Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´Ñ‹ (Ğ¾Ğ±Ñ‰Ğ°Ñ Ğ‘Ğ” Ğ¿Ğ¾ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´Ğ°Ğ¼)
function loadGlobalPromos() {
  try {
    const raw = localStorage.getItem('giftbot_promos');
    return raw ? JSON.parse(raw) : {};
  } catch { return {}; }
}

function saveGlobalPromos(db) {
  try { localStorage.setItem('giftbot_promos', JSON.stringify(db)); } catch {}
}

const saved = loadState();
const today = new Date().toLocaleDateString('ru-RU', { day:'numeric', month:'long', year:'numeric' });
const globalPromos = loadGlobalPromos();

const S = {
  user: TGUser,
  balance: saved ? saved.balance : 1000,
  doneTasks: new Set(saved ? saved.doneTasks : []),
  usedPromos: new Set(saved ? saved.usedPromos : []),
  globalUsedPromos: new Set(saved ? saved.globalPromos : []),
  joinedRaffles: new Set(saved ? saved.joinedRaffles : []),
  regDate: saved ? saved.regDate : today,
  refs: saved ? saved.refs : [],          // ÑĞ¿Ğ¸ÑĞ¾Ğº Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ¾Ğ² [{name,date}]
  refEarned: saved ? saved.refEarned : 0, // Ğ·Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ¾ Ñ Ñ€ĞµÑ„Ğ¾Ğ²
  refBy: saved ? saved.refBy : null,      // ĞºÑ‚Ğ¾ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ğ»
};

/* ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ñ€ĞµÑ„-Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ° Ğ¸Ğ· ÑÑ‚Ğ°Ñ€Ñ‚Ğ¾Ğ²Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞ¸ */
function processRefParam() {
  try {
    const sp = tg?.initDataUnsafe?.start_param || '';
    if (!sp.startsWith('ref_')) return;
    const refUID = sp.replace('ref_', '');
    if (refUID === UID || S.refBy) return;
    // Ğ—Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµĞ¼ ĞºÑ‚Ğ¾ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ğ»
    S.refBy = refUID;
    // ĞĞ°Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ğ²ÑˆĞµĞ¼Ñƒ
    const refKey = 'giftbot_' + refUID;
    try {
      const rd = JSON.parse(localStorage.getItem(refKey) || '{}');
      if (!rd.refs) rd.refs = [];
      const uname = TGUser.username ? '@'+TGUser.username : TGUser.first_name;
      rd.refs.push({ name: uname, date: today });
      if (!rd.balance) rd.balance = 1000;
      rd.balance += 1000;
      if (!rd.refEarned) rd.refEarned = 0;
      rd.refEarned += 1000;
      // Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ° 3 Ñ€ĞµÑ„Ğ¾Ğ²
      if (rd.refs.length === 3 && !rd.task3refs) {
        rd.balance += 2000;
        rd.task3refs = true;
      }
      localStorage.setItem(refKey, JSON.stringify(rd));
    } catch {}
    saveState();
  } catch {}
}
processRefParam();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const TASKS = [
  {id:1, ico:'ğŸ“¢', tag:'ĞšĞ°Ğ½Ğ°Ğ»',   tc:'r', name:'ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒÑÑ Ğ½Ğ° ĞºĞ°Ğ½Ğ°Ğ»',      desc:'ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑˆĞ¸ÑÑŒ Ğ½Ğ° Ğ½Ğ°Ñˆ Telegram-ĞºĞ°Ğ½Ğ°Ğ»',        rew:100},
  {id:2, ico:'ğŸ’¬', tag:'Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ', tc:'r', name:'ĞĞ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ Ğ² Ñ‡Ğ°Ñ‚',            desc:'ĞĞ°Ğ¿Ğ¸ÑˆĞ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ² Ğ½Ğ°Ñˆ Telegram-Ñ‡Ğ°Ñ‚',    rew:50},
  {id:3, ico:'â­', tag:'Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ', tc:'r', name:'ĞÑ†ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ±Ğ¾Ñ‚Ğ°',              desc:'ĞŸĞ¾ÑÑ‚Ğ°Ğ²ÑŒ 5 Ğ·Ğ²Ñ‘Ğ·Ğ´ Ğ² ĞºĞ°Ñ‚Ğ°Ğ»Ğ¾Ğ³Ğµ',             rew:75},
  {id:4, ico:'ğŸ‘¥', tag:'Ğ”Ñ€ÑƒĞ·ÑŒÑ',  tc:'g', name:'ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ñ‚ÑŒ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ´Ñ€ÑƒĞ³Ğ°',  desc:'ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸ Ğ´Ñ€ÑƒĞ³Ğ° Ğ¿Ğ¾ Ñ€ĞµÑ„-ÑÑÑ‹Ğ»ĞºĞµ',           rew:1000},
  {id:5, ico:'ğŸ””', tag:'ĞšĞ°Ğ½Ğ°Ğ»',   tc:'r', name:'Ğ’ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ',      desc:'Ğ’ĞºĞ»ÑÑ‡Ğ¸ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ² Ğ½Ğ°ÑˆĞµĞ¼ ĞºĞ°Ğ½Ğ°Ğ»Ğµ',      rew:30},
  {id:6, ico:'ğŸ“¦', tag:'Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ', tc:'r', name:'ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ ĞºĞµĞ¹Ñ',       desc:'ĞÑ‚ĞºÑ€Ğ¾Ğ¹ Ğ»ÑĞ±Ğ¾Ğ¹ ĞºĞµĞ¹Ñ Ğ² Ñ€Ğ°Ğ·Ğ´ĞµĞ»Ğµ ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½',    rew:200},
];

const ITEMS = [
  {id:1, ico:'ğŸ', name:'Ğ¡Ğ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ´Ğ°Ñ€Ğ¾Ğº', price:150},
  {id:2, ico:'ğŸ’', name:'ĞšÑ€Ğ¸ÑÑ‚Ğ°Ğ»Ğ» ÑƒĞ´Ğ°Ñ‡Ğ¸',   price:300},
  {id:3, ico:'ğŸ†', name:'VIP Ğ½Ğ° 7 Ğ´Ğ½ĞµĞ¹',    price:500},
  {id:4, ico:'ğŸ°', name:'Ğ”Ğ¾Ğ¿. Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ°',     price:200},
  {id:5, ico:'ğŸŒˆ', name:'Ğ¦Ğ²ĞµÑ‚Ğ½Ğ¾Ğ¹ Ğ½Ğ¸Ğº',      price:250},
  {id:6, ico:'âœ¨', name:'Ğ‘ÑƒÑÑ‚ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ¾Ğ²',   price:400},
];

// ĞšĞµĞ¹ÑÑ‹ Ñ SVG Ğ¸ĞºĞ¾Ğ½ĞºĞ°Ğ¼Ğ¸ (Ğ½Ğµ ÑĞ¼Ğ¾Ğ´Ğ·Ğ¸)
const CASES = [
  {
    id:1, name:'Ğ¡Ñ‚Ğ°Ñ€Ñ‚Ğ¾Ğ²Ñ‹Ğ¹', price:50,
    bg:'linear-gradient(145deg,#0d1f14,#122010)',
    iconColor:'#2ecc71',
    iconBg:'rgba(46,204,113,0.15)',
    icon:`<svg viewBox="0 0 24 24" stroke="#2ecc71"><path d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>`,
    drops:[{i:'ğŸª™',n:'ĞœĞ¾Ğ½ĞµÑ‚Ñ‹',v:'+50'},{i:'ğŸ',n:'ĞŸĞ¾Ğ´Ğ°Ñ€Ğ¾Ğº',v:'x1'},{i:'â­',n:'Ğ‘Ğ¾Ğ½ÑƒÑ',v:'+20'},{i:'ğŸ’',n:'ĞšÑ€Ğ¸ÑÑ‚Ğ°Ğ»Ğ»',v:'x1'},{i:'ğŸ”¥',n:'Ğ‘ÑƒÑÑ‚',v:'+5%'},{i:'ğŸª™',n:'ĞœĞ¾Ğ½ĞµÑ‚Ñ‹',v:'+100'},{i:'ğŸŸï¸',n:'Ğ‘Ğ¸Ğ»ĞµÑ‚',v:'x1'},{i:'ğŸ†',n:'VIP',v:'1 Ğ´ĞµĞ½ÑŒ'}]
  },
  {
    id:2, name:'ĞĞ±Ñ‹Ñ‡Ğ½Ñ‹Ğ¹', price:150,
    bg:'linear-gradient(145deg,#0d1428,#101828)',
    iconColor:'#5B8DEF',
    iconBg:'rgba(91,141,239,0.15)',
    icon:`<svg viewBox="0 0 24 24" stroke="#5B8DEF"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M16 7V5a2 2 0 00-2-2h-4a2 2 0 00-2 2v2"/><line x1="12" y1="12" x2="12" y2="16"/><line x1="10" y1="14" x2="14" y2="14"/></svg>`,
    drops:[{i:'ğŸ’°',n:'ĞœĞ¾Ğ½ĞµÑ‚Ñ‹',v:'+200'},{i:'ğŸ',n:'ĞŸĞ¾Ğ´Ğ°Ñ€Ğ¾Ğº',v:'x2'},{i:'ğŸ’',n:'ĞšÑ€Ğ¸ÑÑ‚Ğ°Ğ»Ğ»',v:'x2'},{i:'ğŸ†',n:'VIP',v:'3 Ğ´Ğ½Ñ'},{i:'â­',n:'Ğ‘Ğ¾Ğ½ÑƒÑ',v:'+100'},{i:'ğŸ”¥',n:'Ğ‘ÑƒÑÑ‚',v:'+15%'},{i:'ğŸŸï¸',n:'Ğ‘Ğ¸Ğ»ĞµÑ‚',v:'x3'},{i:'ğŸŒŸ',n:'Ğ¡ÑƒĞ¿ĞµÑ€',v:'x1'}]
  },
  {
    id:3, name:'Ğ—Ğ¾Ğ»Ğ¾Ñ‚Ğ¾Ğ¹', price:500,
    bg:'linear-gradient(145deg,#1a1500,#1e1800)',
    iconColor:'#F4C430',
    iconBg:'rgba(244,196,48,0.15)',
    icon:`<svg viewBox="0 0 24 24" stroke="#F4C430"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>`,
    drops:[{i:'ğŸ’°',n:'ĞœĞ¾Ğ½ĞµÑ‚Ñ‹',v:'+1000'},{i:'ğŸ†',n:'VIP',v:'7 Ğ´Ğ½ĞµĞ¹'},{i:'ğŸ’',n:'ĞšÑ€Ğ¸ÑÑ‚Ğ°Ğ»Ğ»',v:'x5'},{i:'ğŸ',n:'ĞŸĞ¾Ğ´Ğ°Ñ€Ğ¾Ğº',v:'x5'},{i:'ğŸŒŸ',n:'Ğ¡ÑƒĞ¿ĞµÑ€',v:'x3'},{i:'ğŸ”¥',n:'Ğ‘ÑƒÑÑ‚',v:'+50%'},{i:'ğŸ‘‘',n:'ĞšĞ¾Ñ€Ğ¾Ğ½Ğ°',v:'x1'},{i:'ğŸ’°',n:'ĞœĞ¾Ğ½ĞµÑ‚Ñ‹',v:'+2000'}]
  },
  {
    id:4, name:'ĞŸÑ€ĞµĞ¼Ğ¸ÑƒĞ¼', price:1000,
    bg:'linear-gradient(145deg,#200a0a,#1a0808)',
    iconColor:'#FF4D4D',
    iconBg:'rgba(255,77,77,0.15)',
    icon:`<svg viewBox="0 0 24 24" stroke="#FF4D4D"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/><circle cx="12" cy="12" r="3" stroke-width="1.5"/></svg>`,
    drops:[{i:'ğŸ‘‘',n:'ĞšĞ¾Ñ€Ğ¾Ğ½Ğ°',v:'x1'},{i:'ğŸ’°',n:'ĞœĞ¾Ğ½ĞµÑ‚Ñ‹',v:'+5000'},{i:'ğŸ†',n:'VIP',v:'30 Ğ´Ğ½ĞµĞ¹'},{i:'ğŸ’',n:'ĞšÑ€Ğ¸ÑÑ‚Ğ°Ğ»Ğ»',v:'x10'},{i:'ğŸŒŸ',n:'Ğ›ĞµĞ³ĞµĞ½Ğ´Ğ°',v:'x1'},{i:'ğŸ',n:'ĞœĞµĞ³Ğ°-Ğ¿Ğ¾Ğ´Ğ°Ñ€Ğ¾Ğº',v:'x1'},{i:'ğŸ”¥',n:'Ğ‘ÑƒÑÑ‚',v:'+100%'},{i:'ğŸ’°',n:'ĞœĞ¾Ğ½ĞµÑ‚Ñ‹',v:'+10000'}]
  },
];

const RAFFLES = [
  {id:1, ico:'ğŸ’°', name:'Ğ Ğ¾Ğ·Ñ‹Ğ³Ñ€Ñ‹Ñˆ $1 000', desc:'Ğ•Ğ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ñ‹Ğ¹ Ñ€Ğ¾Ğ·Ñ‹Ğ³Ñ€Ñ‹Ñˆ', prize:'$1,000', entry:50, parts:47, max:100},
  {id:2, ico:'ğŸ“±', name:'iPhone 17',       desc:'Ğ•Ğ¶ĞµĞ½ĞµĞ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¸Ğ·',   prize:'iPhone 17', entry:200, parts:23, max:50},
  {id:3, ico:'ğŸ®', name:'PlayStation 5',   desc:'Ğ•Ğ¶ĞµĞ¼ĞµÑÑÑ‡Ğ½Ñ‹Ğ¹ Ğ³Ñ€Ğ°Ğ½Ğ´',   prize:'PS5', entry:100, parts:67, max:100},
];

// ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´Ñ‹ â€” Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚: ĞºĞ¾Ğ´: {reward, maxUses, desc}
// Ğ”Ğ»Ñ Ğ¿Ñ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ñ Ğ°Ğ±ÑŒÑĞ·Ğ°: ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´ 1 Ñ€Ğ°Ğ· Ğ½Ğ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
const PROMOS = {
  'GIFT100':  { reward: 100,  desc: '+100 Ğ¼Ğ¾Ğ½ĞµÑ‚' },
  'BONUS50':  { reward: 50,   desc: '+50 Ğ¼Ğ¾Ğ½ĞµÑ‚' },
  'START200': { reward: 200,  desc: '+200 Ğ¼Ğ¾Ğ½ĞµÑ‚' },
  'WELCOME':  { reward: 75,   desc: '+75 Ğ¼Ğ¾Ğ½ĞµÑ‚' },
  'VIP500':   { reward: 500,  desc: '+500 Ğ¼Ğ¾Ğ½ĞµÑ‚' },
  'NEW1000':  { reward: 1000, desc: '+1000 Ğ¼Ğ¾Ğ½ĞµÑ‚' },
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NAVIGATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const PAGES = ['home','tasks','shop','friends','profile','raffles'];
let curPage = 'home';
let navLocked = false;

function go(name) {
  if (name === curPage || navLocked) return;
  navLocked = true;

  const oldPage = document.getElementById('page-' + curPage);
  const newPage = document.getElementById('page-' + name);

  // Exit animation on old
  oldPage.classList.add('exit');
  oldPage.addEventListener('animationend', () => {
    oldPage.classList.remove('active', 'exit');
    oldPage.style.display = 'none';
  }, { once: true });

  // Enter animation on new
  setTimeout(() => {
    newPage.style.display = 'block';
    newPage.classList.add('active');
    newPage.addEventListener('animationend', () => {
      navLocked = false;
    }, { once: true });
  }, 80);

  // Nav buttons
  PAGES.forEach(p => {
    const el = document.getElementById('nb-' + p);
    if (el) el.classList.remove('active');
  });
  const nb = document.getElementById('nb-' + name);
  if (nb) nb.classList.add('active');

  curPage = name;
  syncB();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BALANCE SYNC
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function syncB() {
  const b = S.balance.toLocaleString('ru');
  ['home','tasks','shop','raffles','friends','profile'].forEach(k => {
    const el = document.getElementById('b-' + k);
    if (el) el.textContent = b;
  });
  const pb = document.getElementById('p-bal');
  if (pb) pb.textContent = S.balance.toLocaleString('ru');
  saveState();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function init() {
  const u = S.user;
  const name = u.first_name || 'User';
  const uname = u.username ? '@' + u.username : 'Ğ‘ĞµĞ· username';

  // Avatar
  function setAv(id) {
    const el = document.getElementById(id);
    if (!el) return;
    if (u.photo_url) {
      el.innerHTML = `<img src="${u.photo_url}" onerror="this.parentElement.textContent='${name[0].toUpperCase()}'">`;
    } else {
      el.textContent = name[0].toUpperCase();
    }
  }
  setAv('av-h'); setAv('av-p');

  document.getElementById('h-name').textContent = name;
  document.getElementById('p-name').textContent = name;
  document.getElementById('p-un').textContent = uname;
  document.getElementById('p-reg').textContent = S.regDate;
  document.getElementById('p-refs').textContent = S.refs.length;

  // Ref link
  const botName = tg?.initDataUnsafe?.bot?.username || 'SATapp_bot';
  const refLink = `https://t.me/${botName}?start=ref_${UID}`;
  document.getElementById('ref-link').textContent = refLink;

  syncB();
  rTasks();
  rShopItems();
  rCases();
  rRaffles();
  rHomeRaf();
  rRefStats();
  rRefList();

  // Keyboard
  document.getElementById('pi-h').addEventListener('keydown', e => { if (e.key === 'Enter') usePromo('pi-h'); });
  document.getElementById('pi-p').addEventListener('keydown', e => { if (e.key === 'Enter') usePromo('pi-p'); });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TASKS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function rTasks() {
  document.getElementById('tasks-list').innerHTML = TASKS.map(t => {
    const done = S.doneTasks.has(t.id);
    return `<div class="gc ti" onclick="${done ? '' : 'doTask(' + t.id + ')'}">
      <div class="tico">${t.ico}</div>
      <div class="tinf">
        <div class="ttag ${t.tc}">${t.tag}</div>
        <div class="tname">${t.name}</div>
        <div class="tdesc">${t.desc}</div>
      </div>
      ${done
        ? '<div class="tdone">âœ“ Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾</div>'
        : `<div class="trew">+${t.rew} ğŸª™</div>`}
    </div>`;
  }).join('');
}

function doTask(id) {
  const t = TASKS.find(x => x.id === id);
  if (!t || S.doneTasks.has(id)) return;
  openSheet(t.name, `Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸ +${t.rew} Ğ¼Ğ¾Ğ½ĞµÑ‚`, 'âœ… Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ', () => {
    S.doneTasks.add(id);
    S.balance += t.rew;
    syncB(); rTasks(); closeSheet();
    showToast(`+${t.rew} Ğ¼Ğ¾Ğ½ĞµÑ‚! ğŸ‰`);
    // Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 4 = Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ñ‚ÑŒ Ğ´Ñ€ÑƒĞ³Ğ°, Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼
    if (id === 4 && S.refs.length > 0 && !S.doneTasks.has(id)) {}
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SHOP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function shopTab(tab, btn) {
  document.querySelectorAll('.stab').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById('shop-items').style.display = tab === 'items' ? 'grid' : 'none';
  document.getElementById('shop-cases').style.display = tab === 'cases' ? 'grid' : 'none';
}

function rShopItems() {
  document.getElementById('shop-items').innerHTML = ITEMS.map(x => {
    const ok = S.balance >= x.price;
    return `<div class="gc sitem">
      <div class="sico">${x.ico}</div>
      <div class="sname">${x.name}</div>
      <div class="sprice">${x.price} ğŸª™</div>
      <button class="sbuy"${ok ? '' : ' disabled'} onclick="buyItem(${x.id})">${ok ? 'ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ' : 'ĞœĞ°Ğ»Ğ¾ Ğ¼Ğ¾Ğ½ĞµÑ‚'}</button>
    </div>`;
  }).join('');
}

function buyItem(id) {
  const x = ITEMS.find(i => i.id === id);
  if (!x || S.balance < x.price) return;
  openSheet(`ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ ${x.name}?`, `Ğ¡Ğ¿Ğ¸ÑˆĞµÑ‚ÑÑ ${x.price} Ğ¼Ğ¾Ğ½ĞµÑ‚`, 'ğŸ›’ ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ', () => {
    S.balance -= x.price;
    syncB(); rShopItems(); closeSheet();
    showToast(`${x.ico} ĞšÑƒĞ¿Ğ»ĞµĞ½Ğ¾!`);
  });
}

function rCases() {
  document.getElementById('shop-cases').innerHTML = CASES.map(c => `
    <div class="gc ccard" onclick="openCase(${c.id})">
      <div class="ccimg" style="background:${c.bg}">
        <div class="ccimg-ico" style="background:${c.iconBg};border:1px solid ${c.iconColor}30">
          ${c.icon}
        </div>
      </div>
      <div class="ccinfo">
        <div class="ccname">${c.name}</div>
        <div class="ccprice">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
          ${c.price}
        </div>
      </div>
    </div>`).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CASE ROULETTE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let curC = null, spinning = false;
const IW = 94;

function openCase(id) {
  curC = CASES.find(c => c.id === id);
  if (!curC) return;
  spinning = false;
  document.getElementById('cm-t').innerHTML = `
    <span style="display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;border-radius:8px;background:${curC.iconBg};margin-right:8px;flex-shrink:0">${curC.icon.replace('width:28px;height:28px', 'width:18px;height:18px')}</span>
    ${curC.name}`;
  document.getElementById('cm-cost').textContent = `Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ: ${curC.price} ğŸª™`;
  const btn = document.getElementById('cm-btn');
  if (S.balance < curC.price) {
    btn.disabled = true;
    btn.textContent = `ĞÑƒĞ¶Ğ½Ğ¾ ${curC.price} ğŸª™`;
  } else {
    btn.disabled = false;
    btn.textContent = 'ğŸ° ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ ĞºĞµĞ¹Ñ';
  }
  document.getElementById('cm-spin').style.display = 'block';
  document.getElementById('cres').classList.remove('show');
  buildReel();
  document.getElementById('cmo').classList.add('show');
}

function buildReel() {
  const track = document.getElementById('rtrack');
  let items = [];
  for (let i = 0; i < 10; i++) items.push(...curC.drops);
  track.innerHTML = items.map((d, idx) =>
    `<div class="ritem" id="ri${idx}">
      <div class="rico">${d.i}</div>
      <div class="rname">${d.n}</div>
      <div class="rval">${d.v}</div>
    </div>`
  ).join('');
  track.style.transition = 'none';
  track.style.transform = 'translateX(0)';
}

function spinCase() {
  if (spinning) return;
  if (S.balance < curC.price) { showToast('âŒ ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ¼Ğ¾Ğ½ĞµÑ‚!'); return; }
  spinning = true;
  S.balance -= curC.price;
  syncB();

  const track = document.getElementById('rtrack');
  const total = curC.drops.length * 10;
  const winIdx = Math.floor(total / 2) + Math.floor(Math.random() * curC.drops.length);
  const cw = track.parentElement.clientWidth;
  const targetX = -(winIdx * IW - cw / 2 + IW / 2);

  track.style.transition = 'none';
  track.style.transform = 'translateX(4px)';
  requestAnimationFrame(() => requestAnimationFrame(() => {
    track.style.transition = 'transform 5s cubic-bezier(0.1,0.82,0.05,1)';
    track.style.transform = `translateX(${targetX}px)`;
  }));

  setTimeout(() => {
    document.querySelectorAll('.ritem').forEach(el => el.classList.remove('win'));
    document.getElementById('ri' + winIdx)?.classList.add('win');
    const winner = curC.drops[winIdx % curC.drops.length];
    setTimeout(() => { showResult(winner); spinning = false; }, 700);
  }, 5000);
}

function showResult(d) {
  document.getElementById('cm-spin').style.display = 'none';
  const r = document.getElementById('cres');
  r.classList.add('show');
  document.getElementById('cr-ico').textContent = d.i;
  document.getElementById('cr-t').textContent = 'Ğ’Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ğ»Ğ¸: ' + d.n;
  document.getElementById('cr-s').textContent = d.v;
  if (d.n === 'ĞœĞ¾Ğ½ĞµÑ‚Ñ‹') {
    const n = parseInt(d.v.replace(/\D/g, '')) || 0;
    S.balance += n;
    syncB();
  }
  showToast('ğŸ‰ ' + d.n + ' ' + d.v + '!');
  // Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ ĞºĞµĞ¹Ñ
  if (!S.doneTasks.has(6)) {
    S.doneTasks.add(6);
    S.balance += 200;
    syncB();
    setTimeout(() => showToast('ğŸ +200 Ğ·Ğ° Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ ĞºĞµĞ¹Ñ!'), 2000);
  }
  rShopItems();
}

function closeCase() {
  document.getElementById('cmo').classList.remove('show');
  rShopItems(); rCases();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RAFFLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function rRaffles() {
  document.getElementById('raffles-list').innerHTML = RAFFLES.map(r => {
    const j = S.joinedRaffles.has(r.id);
    const pct = Math.round(r.parts / r.max * 100);
    return `<div class="gc rcard">
      <div class="rchdr">
        <div class="rcico">${r.ico}</div>
        <div class="rcinfo">
          <div class="rcname">${r.name}</div>
          <div class="rcdesc">${r.desc}</div>
        </div>
        <div class="rcprize">${r.prize}</div>
      </div>
      <div class="rprog"><div class="rfill" style="width:${pct}%"></div></div>
      <div class="rcft">
        <div class="rcparts">${r.parts}/${r.max} ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¾Ğ²</div>
        ${j
          ? '<div class="rjoined">âœ“ Ğ£Ñ‡Ğ°ÑÑ‚Ğ²ÑƒÑ</div>'
          : `<button class="rjoin" onclick="joinRaffle(${r.id})">+${r.entry} ğŸª™</button>`}
      </div>
    </div>`;
  }).join('');
}

function joinRaffle(id) {
  const r = RAFFLES.find(x => x.id === id);
  if (!r || S.joinedRaffles.has(id)) return;
  if (S.balance < r.entry) { showToast('âŒ ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ¼Ğ¾Ğ½ĞµÑ‚!'); return; }
  openSheet('Ğ£Ñ‡Ğ°ÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² Ñ€Ğ¾Ğ·Ñ‹Ğ³Ñ€Ñ‹ÑˆĞµ?', `Ğ¡Ğ¿Ğ¸ÑˆĞµÑ‚ÑÑ ${r.entry} Ğ¼Ğ¾Ğ½ĞµÑ‚. ĞŸÑ€Ğ¸Ğ·: ${r.prize}`, 'ğŸ Ğ£Ñ‡Ğ°ÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ñ‚ÑŒ', () => {
    S.balance -= r.entry;
    S.joinedRaffles.add(id);
    syncB(); rRaffles(); closeSheet();
    showToast('ğŸ‰ Ğ’Ñ‹ ÑƒÑ‡Ğ°ÑÑ‚Ğ²ÑƒĞµÑ‚Ğµ!');
  });
}

function rHomeRaf() {
  document.getElementById('h-raf').innerHTML = RAFFLES.map(r => `
    <div class="rthumb" onclick="go('raffles')">
      <div class="rtbg">${r.ico}</div>
      <div class="rtlbl">
        <div class="rtprize">${r.prize}</div>
        <div class="rtsub">${r.parts}/${r.max} ÑƒÑ‡.</div>
      </div>
    </div>`).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FRIENDS / REF SYSTEM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function rRefStats() {
  document.getElementById('ref-count1').textContent = S.refs.length;
  document.getElementById('ref-count2').textContent = 0; // 2-Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ Ğ² Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ¼
  const earnEl = document.getElementById('ref-earned');
  earnEl.innerHTML = `<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>${S.refEarned.toLocaleString('ru')}`;

  const p = document.getElementById('ref-prog-bar');
  const t = document.getElementById('ref-prog-txt');
  const cnt = Math.min(S.refs.length, 3);
  if (p) p.style.width = (cnt / 3 * 100) + '%';
  if (t) t.textContent = cnt + ' / 3';

  document.getElementById('p-refs').textContent = S.refs.length;
}

function rRefList() {
  const el = document.getElementById('ref-list');
  if (!el) return;
  if (!S.refs.length) {
    el.innerHTML = `<div class="norefs">
      <div class="nrico">ğŸ‘¥</div>
      <div class="nrt">ĞŸĞ¾ĞºĞ° Ğ½ĞµÑ‚ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ¾Ğ²</div>
      <div class="nrs">ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ĞµÑÑŒ ÑÑÑ‹Ğ»ĞºĞ¾Ğ¹ Ñ Ğ´Ñ€ÑƒĞ·ÑŒÑĞ¼Ğ¸,<br>Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ğ¼Ğ¾Ğ½ĞµÑ‚Ñ‹</div>
    </div>`;
    return;
  }
  el.innerHTML = S.refs.map(r => `
    <div class="gc" style="padding:11px 14px;margin-bottom:8px;display:flex;align-items:center;gap:12px">
      <div style="width:38px;height:38px;border-radius:50%;background:var(--gdim);border:1px solid var(--gbor);display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0">ğŸ‘¤</div>
      <div style="flex:1">
        <div style="font-size:13px;font-weight:600">${r.name}</div>
        <div style="font-size:11px;color:var(--muted2)">${r.date}</div>
      </div>
      <div style="color:var(--green);font-size:12px;font-weight:700">+1000 ğŸª™</div>
    </div>`).join('');
}

function copyRef() {
  const t = document.getElementById('ref-link').textContent;
  navigator.clipboard?.writeText(t).catch(() => {});
  showToast('ğŸ“‹ Ğ¡ÑÑ‹Ğ»ĞºĞ° ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°!');
}

function shareRef() {
  const t = document.getElementById('ref-link').textContent;
  const msg = encodeURIComponent('ğŸ ĞŸÑ€Ğ¸ÑĞ¾ĞµĞ´Ğ¸Ğ½ÑĞ¹ÑÑ Ğº SAT Bot Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸ 1000 Ğ¼Ğ¾Ğ½ĞµÑ‚!\nĞ—Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ¹, Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑÑ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¸ ÑƒÑ‡Ğ°ÑÑ‚Ğ²ÑƒĞ¹ Ğ² Ñ€Ğ¾Ğ·Ñ‹Ğ³Ñ€Ñ‹ÑˆĞ°Ñ…!');
  if (tg) {
    tg.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(t)}&text=${msg}`);
  } else {
    copyRef();
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROMO (anti-abuse: per-user + global check)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function usePromo(inputId) {
  const el = document.getElementById(inputId);
  const code = (el.value || '').trim().toUpperCase();
  if (!code) { showToast('Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´'); return; }

  // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° 1: ÑƒĞ¶Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½ ÑÑ‚Ğ¸Ğ¼ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼
  if (S.usedPromos.has(code)) {
    showToast('âŒ Ğ’Ñ‹ ÑƒĞ¶Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ»Ğ¸ ÑÑ‚Ğ¾Ñ‚ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´');
    el.value = '';
    return;
  }

  // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° 2: Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ğ¾ÑÑ‚ÑŒ
  const promo = PROMOS[code];
  if (!promo) {
    showToast('âŒ ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´');
    return;
  }

  // ĞĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒĞµĞ¼
  S.usedPromos.add(code);
  S.globalUsedPromos.add(code);
  S.balance += promo.reward;
  el.value = '';
  syncB();
  rShopItems();
  showToast(`âœ… +${promo.reward} Ğ¼Ğ¾Ğ½ĞµÑ‚ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾!`);

  // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½ÑƒÑ Ğ‘Ğ”
  if (!globalPromos[code]) globalPromos[code] = [];
  globalPromos[code].push({ uid: UID, date: today });
  saveGlobalPromos(globalPromos);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BOTTOM SHEET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let _scb = null;
function openSheet(title, sub, label, cb) {
  document.getElementById('sh-t').textContent = title;
  document.getElementById('sh-s').textContent = sub;
  document.getElementById('sh-a').textContent = label;
  _scb = cb;
  document.getElementById('sheet').classList.add('show');
}
function closeSheet(e) {
  if (e && e.target !== document.getElementById('sheet')) return;
  document.getElementById('sheet').classList.remove('show');
  _scb = null;
}
function doSheet() { if (_scb) _scb(); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let _tt;
function showToast(msg) {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.classList.add('show');
  clearTimeout(_tt);
  _tt = setTimeout(() => el.classList.remove('show'), 2800);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   START
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
init();
</script>
</body>
</html>